{% extends 'core/base.html' %}

{% block title %}{{ title }} | NayxusStock{% endblock %}

{% block content %}
<div class="page-header">
    <div class="header-title">
        <h1 class="page-title">{{ title }}</h1>
    </div>
</div>

<div
    style="background-color: var(--bg-secondary); padding: 30px; border-radius: 8px; max-width: 800px; margin: 0 auto;">
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

        {% for field in form %}
        <div style="margin-bottom: 20px;">
            <label for="{{ field.id_for_label }}"
                style="display: block; margin-bottom: 8px; color: var(--text-secondary);">{{ field.label }}</label>
            {{ field.errors }}
            <div class="input-wrapper">
                {{ field }}
            </div>
            {% if field.help_text %}
            <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 5px;">{{ field.help_text }}</p>
            {% endif %}
        </div>
        {% endfor %}

        <div style="margin-top: 30px; display: flex; gap: 10px;">
            <button type="submit" class="btn btn-primary">Enregistrer</button>
            <a href="{% url 'product_list' %}" class="btn btn-outline">Annuler</a>
        </div>
    </form>
</div>

<!-- Section Rapport des Entrées -->
<div
    style="background-color: var(--bg-secondary); padding: 30px; border-radius: 8px; max-width: 800px; margin: 30px auto; border: 1px solid var(--border-color);">
    <h2 style="font-size: 1.25rem; margin-bottom: 20px; color: var(--text-primary); border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">
        <i class="fas fa-file-alt"></i> Rapport des Entrées (Produits entrés)
    </h2>
    <div style="display: flex; flex-wrap: wrap; gap: 15px; align-items: flex-end;">
        <div style="flex: 1; min-width: 150px;">
            <label style="display: block; margin-bottom: 8px; font-size: 0.85rem; color: var(--text-secondary);">Date de début</label>
            <input type="date" id="report_start_date" style="padding: 10px; border-radius: 6px; border: 1px solid var(--border-color); background: var(--bg-primary); color: var(--text-primary); width: 100%;">
        </div>
        <div style="flex: 1; min-width: 150px;">
            <label style="display: block; margin-bottom: 8px; font-size: 0.85rem; color: var(--text-secondary);">Date de fin</label>
            <input type="date" id="report_end_date" style="padding: 10px; border-radius: 6px; border: 1px solid var(--border-color); background: var(--bg-primary); color: var(--text-primary); width: 100%;">
        </div>
        <button type="button" onclick="generateReport()" class="btn btn-outline" style="background: var(--accent); color: white; border: none; padding: 11px 25px;">
            <i class="fas fa-print"></i> Afficher
        </button>
    </div>
</div>

<script>
function generateReport() {
    const start = document.getElementById('report_start_date').value;
    const end = document.getElementById('report_end_date').value;
    
    let url = "{% url 'stock_entry_report' %}?";
    if (start) url += "start_date=" + start + "&";
    if (end) url += "end_date=" + end;
    
    window.open(url, '_blank');
}
</script>

<style>
    /* Form specifics */
    input[type="text"],
    input[type="number"],
    textarea,
    select {
        width: 100%;
        padding: 10px 15px;
        background-color: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: 6px;
        color: var(--text-primary);
        font-family: inherit;
    }

    input:focus,
    textarea:focus,
    select:focus {
        outline: none;
        border-color: var(--accent);
    }

    .input-wrapper input {
        width: 100%;
    }
</style>
{% endblock %}